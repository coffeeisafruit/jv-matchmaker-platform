{% extends 'base.html' %}

{% block title %}Dashboard - JV Matchmaker{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-6 py-12">
    <!-- Header -->
    <div class="mb-10 animate-fade-in">
        <h1 class="text-3xl font-semibold text-apple-gray-600 tracking-tight">
            Welcome back{% if business_name %}, {{ business_name }}{% endif %}
        </h1>
        <p class="mt-2 text-apple-gray-400">
            Here's your overview for this month.
        </p>
    </div>

    <!-- Empty State for New Users -->
    {% if not onboarding_completed %}
    <div class="mb-10 animate-fade-in stagger-1">
        <div class="card p-8 md:p-12 border-2 border-apple-blue/20 bg-gradient-to-br from-apple-blue/5 to-blue-50/30">
            <div class="max-w-3xl mx-auto text-center">
                <!-- Icon -->
                <div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-apple-blue/10 flex items-center justify-center">
                    <svg class="h-8 w-8 text-apple-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                </div>

                <!-- Welcome Message -->
                <h2 class="text-2xl md:text-3xl font-semibold text-apple-gray-600 mb-3">
                    Welcome to JV Matchmaker!
                </h2>
                <p class="text-base text-apple-gray-500 mb-8 max-w-2xl mx-auto">
                    Let's get you started on finding the perfect partnership opportunities.
                    First, you'll need to create an Ideal Customer Profile (ICP) to define your target market
                    and positioning. This helps us match you with compatible partners.
                </p>

                <!-- CTA Button -->
                <a href="{% url 'positioning:icp_list' %}"
                   class="inline-flex items-center px-8 py-4 text-base font-semibold rounded-full bg-apple-blue text-white hover:bg-blue-600 transition-all hover:scale-105 shadow-lg hover:shadow-xl">
                    Create Your First ICP
                    <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </a>

                <!-- Steps Guide -->
                <div class="mt-10 pt-8 border-t border-apple-gray-200">
                    <p class="text-sm font-medium text-apple-gray-500 mb-6">Here's what happens next:</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                        <div class="flex items-start space-x-3">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-apple-blue/10 flex items-center justify-center">
                                <span class="text-sm font-semibold text-apple-blue">1</span>
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-apple-gray-600 mb-1">Define Your ICP</h3>
                                <p class="text-xs text-apple-gray-400">Tell us about your ideal customer and market positioning</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-apple-blue/10 flex items-center justify-center">
                                <span class="text-sm font-semibold text-apple-blue">2</span>
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-apple-gray-600 mb-1">Discover Matches</h3>
                                <p class="text-xs text-apple-gray-400">Browse potential partners who complement your offering</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full bg-apple-blue/10 flex items-center justify-center">
                                <span class="text-sm font-semibold text-apple-blue">3</span>
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-apple-gray-600 mb-1">Start Outreach</h3>
                                <p class="text-xs text-apple-gray-400">Generate personalized pitches and connect with partners</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Monthly ICP Review Prompt -->
    {% if icp_review_due and primary_icp %}
    <div class="mb-10 animate-fade-in stagger-1">
        <div class="card p-6 border-2 border-amber-200 bg-gradient-to-br from-amber-50/50 to-orange-50/30">
            <div class="flex items-start space-x-4">
                <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-amber-100 flex items-center justify-center">
                    <svg class="h-6 w-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <div class="flex-1">
                    <h3 class="text-lg font-semibold text-apple-gray-600 mb-1">
                        Monthly ICP Check-in
                    </h3>
                    <p class="text-sm text-apple-gray-500 mb-4">
                        It's been a month since you last reviewed your ICP. Take a moment to confirm it's still accurate,
                        or update it if your business focus has evolved.
                    </p>

                    <!-- Current ICP Summary -->
                    <div class="bg-white/60 rounded-lg p-4 mb-4 border border-amber-100">
                        <p class="text-xs font-medium text-apple-gray-400 uppercase tracking-wide mb-2">Current ICP</p>
                        <p class="text-sm font-semibold text-apple-gray-600">{{ primary_icp.name }}</p>
                        {% if primary_icp.industry %}
                        <p class="text-sm text-apple-gray-500">{{ primary_icp.industry }}</p>
                        {% endif %}
                    </div>

                    <div class="flex flex-wrap gap-3">
                        <form method="post" action="{% url 'core:icp_review' %}">
                            {% csrf_token %}
                            <button type="submit"
                                    class="inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg bg-amber-500 text-white hover:bg-amber-600 transition-colors">
                                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                </svg>
                                Still Accurate
                            </button>
                        </form>
                        <a href="{% url 'positioning:icp_detail' primary_icp.id %}"
                           class="inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg border border-apple-gray-300 text-apple-gray-600 hover:bg-apple-gray-50 transition-colors">
                            <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                            </svg>
                            Review & Update
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Stats Cards -->
    <div id="stats-cards"
         hx-get="{% url 'core:dashboard_stats' %}"
         hx-trigger="every 60s"
         hx-swap="innerHTML"
         class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 animate-fade-in stagger-2">

        <!-- Matches This Month -->
        <div class="card p-6">
            <div class="flex items-center justify-between">
                <p class="text-sm font-medium text-apple-gray-400">Matches This Month</p>
                <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center">
                    <svg class="h-5 w-5 text-apple-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                </div>
            </div>
            <p class="mt-3 text-3xl font-semibold text-apple-gray-600">{{ matches_this_month }}</p>
            <div class="mt-4">
                <div class="flex items-center justify-between text-xs text-apple-gray-400 mb-2">
                    <span>Usage</span>
                    <span>{{ matches_this_month }}/{{ max_matches }}</span>
                </div>
                <div class="w-full bg-apple-gray-100 rounded-full h-1.5">
                    <div class="bg-apple-blue h-1.5 rounded-full transition-all" style="width: {{ matches_progress }}%"></div>
                </div>
            </div>
        </div>

        <!-- PVPs This Month -->
        <div class="card p-6">
            <div class="flex items-center justify-between">
                <p class="text-sm font-medium text-apple-gray-400">Pitches This Month</p>
                <div class="w-10 h-10 rounded-full bg-green-50 flex items-center justify-center">
                    <svg class="h-5 w-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                </div>
            </div>
            <p class="mt-3 text-3xl font-semibold text-apple-gray-600">{{ pvps_this_month }}</p>
            <div class="mt-4">
                <div class="flex items-center justify-between text-xs text-apple-gray-400 mb-2">
                    <span>Usage</span>
                    <span>{{ pvps_this_month }}/{{ max_pvps }}</span>
                </div>
                <div class="w-full bg-apple-gray-100 rounded-full h-1.5">
                    <div class="bg-green-500 h-1.5 rounded-full transition-all" style="width: {{ pvps_progress }}%"></div>
                </div>
            </div>
        </div>

        <!-- Current Tier -->
        <div class="card p-6">
            <div class="flex items-center justify-between">
                <p class="text-sm font-medium text-apple-gray-400">Current Tier</p>
                <div class="w-10 h-10 rounded-full bg-purple-50 flex items-center justify-center">
                    <svg class="h-5 w-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                    </svg>
                </div>
            </div>
            <p class="mt-3 text-3xl font-semibold text-apple-gray-600">{{ tier }}</p>
            <div class="mt-4">
                {% if tier_value == 'free' %}
                <a href="#" class="text-sm text-apple-blue hover:underline">
                    Upgrade to unlock more
                </a>
                {% else %}
                <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-50 text-green-700">
                    Active
                </span>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="mb-12 animate-fade-in stagger-3">
        <h2 class="text-lg font-semibold text-apple-gray-600 mb-5">Quick Actions</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <a href="{% url 'positioning:icp_list' %}" class="card card-hover p-5 group transition-shadow">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-xl bg-apple-gray-100 flex items-center justify-center group-hover:bg-apple-blue/10 transition-colors">
                        <svg class="h-5 w-5 text-apple-gray-500 group-hover:text-apple-blue transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-semibold text-apple-gray-600">Create ICP</h3>
                        <p class="text-xs text-apple-gray-400">Define your positioning</p>
                    </div>
                </div>
            </a>

            <a href="{% url 'matching:profile-list' %}" class="card card-hover p-5 group transition-shadow">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-xl bg-apple-gray-100 flex items-center justify-center group-hover:bg-apple-blue/10 transition-colors">
                        <svg class="h-5 w-5 text-apple-gray-500 group-hover:text-apple-blue transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-semibold text-apple-gray-600">Find Matches</h3>
                        <p class="text-xs text-apple-gray-400">Discover partners</p>
                    </div>
                </div>
            </a>

            <a href="{% url 'outreach:pvp_generator' %}" class="card card-hover p-5 group transition-shadow">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-xl bg-apple-gray-100 flex items-center justify-center group-hover:bg-apple-blue/10 transition-colors">
                        <svg class="h-5 w-5 text-apple-gray-500 group-hover:text-apple-blue transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-semibold text-apple-gray-600">Start Outreach</h3>
                        <p class="text-xs text-apple-gray-400">Connect with partners</p>
                    </div>
                </div>
            </a>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="animate-fade-in stagger-4">
        <h2 class="text-lg font-semibold text-apple-gray-600 mb-5">Recent Activity</h2>
        <div class="card p-8">
            <div class="text-center py-8">
                <div class="w-12 h-12 mx-auto mb-4 rounded-full bg-apple-gray-100 flex items-center justify-center">
                    <svg class="h-6 w-6 text-apple-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                    </svg>
                </div>
                <p class="text-apple-gray-500 font-medium">No recent activity</p>
                <p class="text-sm text-apple-gray-400 mt-1">Start by creating an ICP or finding matches.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
